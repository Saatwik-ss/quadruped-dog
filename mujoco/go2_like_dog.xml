<mujoco model="SimpleHopper_v3_Flipped">

  <compiler angle="degree"/>

  <option timestep="0.002" gravity="0 0 -9.81">
    <flag contact="enable"/>
  </option>

  <visual>
    <map znear="0.01"/>
    <headlight ambient="0.4 0.4 0.4" diffuse="0.8 0.8 0.8" specular="0.1 0.1 0.1"/>
  </visual>

  <asset>
    <texture type="2d" name="groundplane" builtin="checker" rgb1=".2 .3 .4" rgb2=".1 .15 .2" width="200" height="200"/>
    <material name="groundmat" texture="groundplane" texrepeat="10 10" reflectance="0.2"/>
    <material name="robotmat" rgba="0.7 0.5 0.3 1.0" specular="0.5" shininess="0.5"/>
    <material name="footmat" rgba="0.2 0.2 0.2 1.0" specular="0.1" shininess="0.1"/>
  </asset>

  <default>
      <joint type="hinge" damping="0.1" armature="0.01" limited="true"/>
      <geom type="capsule" size="0.04" material="robotmat"/>
      <motor ctrllimited="true" ctrlrange="-1.0 1.0"/>
  </default>

  <!-- Keyframe with Flipped Orientation -->
  <keyframe>
    <!-- qpos order: freejoint(7) + hip(1) + knee(1) -->
    <!-- freejoint: x,y,z, qw,qx,qy,qz -->
    <!-- Quaternion changed from (1 0 0 0) to (0 1 0 0) for 180deg flip around X -->
    <key name="init" qpos="0 0 1.2 0 1 0 0 0 0" />
  </keyframe>

  <worldbody>
    <geom name="ground" type="plane" size="20 20 0.1" material="groundmat" condim="3"/>
    <light name="mainlight" pos="0 0 5" dir="0 0 -1" diffuse="1.2 1.2 1.2" specular="0.1 0.1 0.1" castshadow="true"/>

    <body name="torso" pos="0 0 1.2"> <!-- Position set by keyframe -->
      <freejoint name="root"/>
      <geom type="capsule" fromto="0 -.07 0 0 .07 0" size="0.06" name="torso_geom" mass="3.0"/>

      <body name="thigh" pos="0 0 0">
        <!-- Using the axis and range from previous attempt, focus is on initial orientation -->
        <joint name="hip" axis="0 1 0" range="-20 150"/>
        <geom fromto="0 0 0  0 0 -0.4" size="0.05" name="thigh_geom" mass="1.0"/>

        <body name="leg" pos="0 0 -0.4">
          <joint name="knee" axis="0 1 0" range="-20 150"/>
          <geom fromto="0 0 0  0 0 -0.3" size="0.04" name="leg_geom" mass="0.7"/>

          <body name="foot" pos="0 0 -0.3">
            <geom type="sphere" size="0.06" name="foot_geom" mass="0.3" material="footmat" condim="3" contype="1" conaffinity="1"/>
          </body> <!-- End Foot -->
        </body> <!-- End Leg -->
      </body> <!-- End Thigh -->
    </body> <!-- End Torso -->

  </worldbody>

  <actuator>
    <motor name="hip_motor"  joint="hip"  gear="150"/>
    <motor name="knee_motor" joint="knee" gear="100"/>
  </actuator>

  <sensor>
    <!-- Sensors remain the same -->
    <jointpos name="hip_pos" joint="hip"/>
    <jointvel name="hip_vel" joint="hip"/>
    <jointpos name="knee_pos" joint="knee"/>
    <jointvel name="knee_vel" joint="knee"/>
    <framepos name="torso_pos" objtype="body" objname="torso"/>
    <framequat name="torso_quat" objtype="body" objname="torso"/>
    <framelinvel name="torso_linvel" objtype="body" objname="torso"/>
    <frameangvel name="torso_angvel" objtype="body" objname="torso"/>
  </sensor>

</mujoco>
